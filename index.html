<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BGclean - Free AI Background Remover Tool</title>
  <style>
    :root {
      --primary: #6366f1;
      --secondary: #a78bfa;
      --accent: #f472b6;
      --success: #34d399;
      --warning: #fbbf24;
      --danger: #f472b6;
      --bg: #f8fafc;
      --white: #fff;
      --shadow: 0 4px 24px 0 rgba(31, 38, 135, 0.10);
      --radius: 18px;
      --footer-bg: #111827;
      --footer-text: #fff;
      --footer-link: #d1d5db;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: #222;
      font-family: 'Segoe UI', 'Inter', Arial, sans-serif;
      overflow-x: hidden;
    }
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .navbar {
      
      background: var(--white);
      box-shadow: 0 2px 12px 0 #e0e7ef33;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 32px;
      height: 70px;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .navbar .logo {
      display: flex;
      align-items: center;
      font-weight: 700;
      font-size: 1.5rem;
      color: var(--primary);
      letter-spacing: 1px;
      gap: 10px;
    }
    .navbar .logo-icon {
      width: 36px; height: 36px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      color: #fff;
      font-size: 1.5rem;
      box-shadow: 0 2px 8px #a78bfa33;
    }
    .navbar .menu {
      display: flex;
      gap: 32px;
      flex-wrap: wrap;
    }
    .navbar .menu a {
      color: #222;
      text-decoration: none;
      font-weight: 500;
      font-size: 1.1rem;
      transition: color 0.2s;
      padding: 0 2px;
      white-space: nowrap;
    }
    .navbar .menu a:hover {
      color: var(--primary);
    }
    .hero {
      max-width: 800px;
      margin: 48px auto 0 auto;
      text-align: center;
    }
    .hero-title {
      font-size: 2.8rem;
      font-weight: 800;
      margin-bottom: 10px;
      color: #222;
      letter-spacing: 1px;
    }
    .hero-title .highlight {
      color: var(--primary);
      background: linear-gradient(90deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .hero-desc {
      font-size: 1.25rem;
      color: #555;
      margin-bottom: 36px;
    }
    .upload-section {
      background: rgba(255,255,255,0.85);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      max-width: 600px;
      margin: 0 auto 32px auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      transition: border-color 0.2s;
    }
    .upload-section:hover {
      border-color: var(--primary);
    }
    .upload-icon {
      width: 120px; height: 85px;
      border-radius: 32px;
      display: block;
      margin: 0 auto 28px auto;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 4.2rem;
      
    }
    .upload-label {
      font-size: 2.1rem;
      margin-bottom: 12px;
      font-weight: 600;
      color: #222;
      cursor: pointer;
      display: block;
    }
    .upload-browse {
      font-size: 2.1rem;
      color: var(--primary);
      text-decoration: underline;
      cursor: pointer;
      font-weight: 500;
      margin-left: 6px;
    }
    .upload-info {
      font-size: 1.3rem;
      color: #888;
      margin-top: 18px;
      margin-bottom: 0;
    }
    .upload-section input[type="file"] {
      display: none;
    }
    .remove-btn {
      font-size: 2rem !important;
      padding: 22px 0 !important;
      border-radius: 18px !important;
      margin-top: 24px !important;
      width: 100%;
      background: linear-gradient(90deg,#6366f1 0%,#a78bfa 100%);
      color: #fff;
      font-weight: 600;
      border: none;
      box-shadow: 0 2px 8px 0 #a78bfa22;
      cursor: pointer;
      transition: background 0.2s,transform 0.15s,box-shadow 0.2s;
    }
    .remove-btn:hover {
      background: linear-gradient(90deg,#a78bfa 0%,#6366f1 100%);
      transform: translateY(-2px) scale(1.01);
      box-shadow: 0 6px 18px 0 #a78bfa22;
    }
    .preview-pair {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 36px;
      margin-top: 32px;
      flex-wrap: wrap;
    }
    .preview-block {
      text-align: center;
    }
    .preview-block img {
      max-width: 220px;
      max-height: 180px;
      border-radius: 12px;
      box-shadow: 0 2px 12px #a78bfa22;
      background: #f3f4f6;
      margin-bottom: 8px;
    }
    .preview-block .label {
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 1.1rem;
    }
    .supported {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 8px #a78bfa11;
      max-width: 520px;
      margin: 32px auto 36px auto;
      padding: 18px 18px 10px 18px;
      text-align: center;
      font-size: 1.15rem;
      color: #444;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .supported strong {
      color: var(--primary);
      font-weight: 600;
    }
    .footer-section {
      background: var(--footer-bg);
      color: var(--footer-text);
      padding: 60px 0 40px 0;
      font-family: 'Inter', Arial, sans-serif;
      letter-spacing: 0.01em;
      margin-top: auto;
    }
    .footer-container {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 40px;
    }
    @media (min-width: 900px) {
      .footer-container {
        grid-template-columns: repeat(4, 1fr);
      }
    }
    .footer-section h4 {
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 18px;
      color: #fff;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      border-bottom: 2px solid #444;
      display: inline-block;
      padding-bottom: 6px;
      margin-top: 0;
    }
    .footer-section ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .footer-section ul li {
      color: var(--footer-link);
      font-size: 1rem;
      margin-bottom: 10px;
      transition: color 0.2s, letter-spacing 0.2s;
      cursor: pointer;
      padding-left: 0;
      position: relative;
    }
    .footer-section ul li:hover {
      color: #fff;
      letter-spacing: 0.03em;
      text-shadow: 0 2px 8px #00000033;
    }
    .footer-section ul li::before {
      content: '';
      display: inline-block;
      width: 6px;
      height: 6px;
      background: linear-gradient(135deg, #60a5fa, #a78bfa, #f472b6);
      border-radius: 50%;
      margin-right: 10px;
      vertical-align: middle;
      transition: background 0.2s;
    }
    .footer-section ul li:hover::before {
      background: linear-gradient(135deg, #f472b6, #60a5fa, #a78bfa);
    }
    @media (max-width: 900px) {
      .footer-container {
        grid-template-columns: 1fr 1fr;
        gap: 24px;
      }
      .preview-pair {
        gap: 16px;
      }
    }
    @media (max-width: 600px) {
      .navbar { padding: 0 8px; height: auto; flex-direction: column; align-items: flex-start; }
      .navbar .menu { gap: 12px; width: 100%; justify-content: flex-start; margin-top: 4px; }
      .hero { margin-top: 24px; padding: 0 6px; }
      .hero-title { font-size: 1.3rem; }
      .upload-section { padding: 18px 6px 14px 6px; max-width: 98vw; }
      .supported { padding: 10px 4px 6px 4px; font-size: 0.97rem; }
      .footer-container { grid-template-columns: 1fr; gap: 18px; }
      .preview-pair { flex-direction: column; gap: 8px; }
      .preview-block img { max-width: 90vw; max-height: 120px; }
    }
    
    /* Custom Color Picker Styles */
    .color-picker-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      padding: 24px;
      z-index: 1000;
      border: 1px solid #e5e7eb;
    }
    
    .color-picker-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
    }
    
    .color-picker-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #e5e7eb;
    }
    
    .color-picker-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #374151;
    }
    
    .color-picker-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #6b7280;
      padding: 4px;
      border-radius: 4px;
      transition: background 0.2s;
    }
    
    .color-picker-close:hover {
      background: #f3f4f6;
    }
    
    .color-picker-input {
      margin-top: 16px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .color-picker-input input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 1rem;
      font-family: monospace;
    }
    
    .color-picker-input input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }
    
    .color-picker-apply {
      background: linear-gradient(90deg, var(--primary), var(--accent));
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
    }
    
    .color-picker-apply:hover {
      transform: translateY(-1px);
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="logo">
      <img class="logo-icon" src="/static/favicon.png" alt="Logo" style="width:36px;height:36px;border-radius:50%;object-fit:cover;vertical-align:middle;box-shadow:0 2px 8px #a78bfa22;margin-right:8px;" />
      BGclean
    </div>
    <div class="menu">
      <a href="{{ url_for('index') }}">Home</a>
      <a href="{{ url_for('about') }}">About Us</a>
      <a href="{{ url_for('contact') }}">Contact Us</a>
      <a href="{{ url_for('terms') }}">Terms & Conditions</a>
    </div>
  </nav>
  <section class="hero" id="hero-section">
    <div class="hero-title">Remove Image Backgrounds<br><span class="highlight">with AI Magic</span></div>
    <div class="hero-desc">Upload your image and watch as our advanced AI removes the background instantly.<br>Then use our Magic Brush tools for pixel-perfect results.</div>
  </section>
  <section>
    <form id="upload-form" enctype="multipart/form-data" autocomplete="off">
      <div class="upload-section" id="drop-area">
        <div id="upload-instructions">
          <div class="upload-icon" id="upload-icon" style="cursor:pointer;display:flex;align-items:center;justify-content:center;">
            <img src="{{ url_for('static', filename='upload.png') }}" alt="Upload" style="width:64px;height:64px;object-fit:contain;" />
          </div>
          <label class="upload-label" for="eimage-input" style="display:flex;flex-direction:column;align-items:center;cursor:pointer;">
            <span style="font-size:1.3rem;">Drop your image here</span>
            <span class="upload-browse" id="browse-link" style="font-size:1.3rem;color:var(--primary);text-decoration:underline;cursor:pointer;margin-top:6px;">or click to browse</span>
            <input type="file" name="image" id="image-input" accept="image/*" required>
          </label>
          <div class="upload-info">
            <span>📷 JPG, PNG, WebP</span> &nbsp; • &nbsp; <span>Max 10MB</span> &nbsp; • &nbsp; <span>HD Quality</span>
          </div>
        </div>
      </div>
    </form>
    <div id="output-area"></div>
    <script>
      const uploadForm = document.getElementById('upload-form');
      const imageInput = document.getElementById('image-input');
      const outputArea = document.getElementById('output-area');
      const uploadInstructions = document.getElementById('upload-instructions');
      const heroSection = document.getElementById('hero-section');
      uploadForm.onsubmit = async function(e) {
        e.preventDefault();
        if (!imageInput.files.length) return;
        // Show progress bar
        outputArea.innerHTML = `
          <div id="progress-container" style="width:320px;margin:40px auto;text-align:center;">
            <div style="font-size:1.2rem;color:#6366f1;margin-bottom:12px;">Processing...</div>
            <div style="background:#e5e7eb;border-radius:8px;height:18px;overflow:hidden;">
              <div id="progress-bar" style="height:100%;width:0%;background:linear-gradient(90deg,#6366f1,#f472b6);transition:width 0.3s;"></div>
            </div>
            <div id="progress-percent" style="margin-top:8px;font-size:1.1rem;color:#6366f1;">0%</div>
          </div>
        `;
        if (heroSection) heroSection.style.display = 'none';
        uploadInstructions.style.display = 'none';

        // Animate progress bar
        let progress = 0;
        const progressBar = document.getElementById('progress-bar');
        const progressPercent = document.getElementById('progress-percent');
        const progressInterval = setInterval(() => {
          if (progress < 90) {
            progress += Math.random() * 5 + 2;
            if (progress > 90) progress = 90;
            progressBar.style.width = progress + '%';
            progressPercent.textContent = Math.floor(progress) + '%';
          }
        }, 200);

        const formData = new FormData(uploadForm);
        const res = await fetch('/', { method: 'POST', body: formData });
        const data = await res.json();

        // Complete progress bar
        clearInterval(progressInterval);
        progressBar.style.width = '100%';
        progressPercent.textContent = '100%';

        setTimeout(() => {
          outputArea.innerHTML = `
            <div style="display:flex;justify-content:center;align-items:stretch;gap:40px;">
              <!-- Image Box -->
              <div class="image-box" style="background:#fff;border-radius:24px;box-shadow:0 4px 32px #a78bfa11;padding:64px 64px 48px 64px;display:flex;flex-direction:column;align-items:center;min-width:900px;">
                <div id="output-wrapper" style="margin-bottom:48px;display:flex;align-items:center;justify-content:center;">
                  <img id="output-img" src="data:image/png;base64,${data.output_image}" alt="Output Image" style="max-width:800px;max-height:800px;border-radius:24px;box-shadow:0 4px 16px #a78bfa22;background:transparent;">
                </div>
                <div style="display:flex;gap:24px;justify-content:center;align-items:center;margin-top:16px;">
                  <a href="data:image/png;base64,${data.output_image}" download="output.png" style="display:inline-block;padding:24px 72px;background:linear-gradient(90deg,#6366f1,#f472b6);color:#fff;border-radius:18px;font-weight:600;text-decoration:none;font-size:1.5rem;box-shadow:0 2px 8px #a78bfa22;">Download</a>
                  <button id='reupload-btn' style='font-size:1.3rem;padding:18px 48px;border-radius:16px;background:#fff;color:#6366f1;font-weight:600;border:2px solid #a78bfa;box-shadow:0 2px 8px #a78bfa22;cursor:pointer;transition:background 0.2s;'>Upload Another</button>
                </div>
              </div>
              <!-- Effects Sidebar -->
              <div id="effects-sidebar" style="display:flex;flex-direction:column;gap:10px;background:rgba(255,255,255,0.7);backdrop-filter:blur(12px);border-radius:18px;padding:24px 14px;box-shadow:0 2px 12px #a78bfa22;align-items:center;min-width:90px;align-self:stretch;justify-content:flex-start;">
                <!-- Background Color -->
                <button id="bgcolor-btn" class="effect-btn" style="display:flex;flex-direction:column;align-items:center;gap:7px;background:none;border:none;cursor:pointer;outline:none;transition:box-shadow 0.2s,background 0.2s;padding:0 0 7px 0;">
                  <span style="display:flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,#f3f4f6,#e0e7ff);box-shadow:0 1px 4px #a78bfa22;font-size:1.1rem;">🎨</span>
                  <span style="font-size:0.85rem;color:#444;font-weight:500;margin-top:2px;">Background</span>
                </button>
                <!-- Erase/Restore -->
                <button id="erase-btn" class="effect-btn" style="display:flex;flex-direction:column;align-items:center;gap:7px;background:none;border:none;cursor:pointer;outline:none;transition:box-shadow 0.2s,background 0.2s;padding:0 0 7px 0;">
                  <span style="display:flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,#fff7ed,#fbbf24);box-shadow:0 1px 4px #a78bfa22;font-size:1.1rem;">🖌️</span>
                  <span style="font-size:0.85rem;color:#444;font-weight:500;margin-top:2px;">Erase/Restore</span>
                </button>
                <!-- Effects -->
                <button id="effects-btn" class="effect-btn" style="display:flex;flex-direction:column;align-items:center;gap:7px;background:none;border:none;cursor:pointer;outline:none;transition:box-shadow 0.2s,background 0.2s;padding:0 0 7px 0;">
                  <span style="display:flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,#f3e8ff,#a78bfa);box-shadow:0 1px 4px #a78bfa22;font-size:1.1rem;">𝑓𝑥</span>
                  <span style="font-size:0.85rem;color:#444;font-weight:500;margin-top:2px;">Effects</span>
                  <select id="effects-select" style="margin-top:6px;width:70px;font-size:0.85rem;padding:2px 4px;border-radius:6px;border:1px solid #a78bfa;">
                    <option value="none">None</option>
                    <option value="grayscale(1)">Grayscale</option>
                    <option value="blur(3px)">Blur</option>
                    <option value="brightness(1.5)">Bright</option>
                    <option value="drop-shadow(0 0 12px #6366f1)">Shadow</option>
                  </select>
                </button>
                <!-- Create Design -->
                <button id="design-btn" class="effect-btn" style="display:flex;flex-direction:column;align-items:center;gap:7px;background:none;border:none;cursor:pointer;outline:none;transition:box-shadow 0.2s,background 0.2s;padding:0 0 7px 0;">
                  <span style="display:flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,#e0e7ff,#a7f3d0);box-shadow:0 1px 4px #a78bfa22;font-size:1.1rem;">🌀</span>
                  <span style="font-size:0.85rem;color:#444;font-weight:500;margin-top:2px;">Create design</span>
                </button>
              </div>
            </div>
          `;
          if (heroSection) heroSection.style.display = 'none';
          uploadInstructions.style.display = 'none';

          document.getElementById('reupload-btn').onclick = function() {
            outputArea.innerHTML = '';
            if (heroSection) heroSection.style.display = '';
            uploadInstructions.style.display = '';
            imageInput.value = '';
          };

          // --- Effects Sidebar Functionality ---
          const outputWrapper = document.getElementById('output-wrapper');
          const outputImg = document.getElementById('output-img');
          const bgcolorPicker = document.getElementById('bgcolor-picker');
          const outlineBtn = null; // not used in new UI
          const eraseBtn = document.getElementById('erase-btn');
          const effectsSelect = document.getElementById('effects-select');
          const designBtn = document.getElementById('design-btn');
          
          // Background color change from sidebar button
          const bgcolorBtn = document.getElementById('bgcolor-btn');
          if (bgcolorBtn && outputWrapper) {
            bgcolorBtn.addEventListener('click', function() {
              showColorPicker(outputWrapper, null);
            });
          }
          
          // Background color change on background click
          if (outputWrapper) {
            outputWrapper.addEventListener('click', function(e) {
              // Only trigger if clicking on the background, not on the image
              if (e.target === outputWrapper) {
                console.log('Background clicked!'); // Debug log
                showColorPicker(outputWrapper, bgcolorPicker);
              }
            });
          }
          // Effects (grayscale, blur, etc)
          if (effectsSelect && outputImg) {
            effectsSelect.addEventListener('change', function(e) {
              outputImg.style.filter = e.target.value;
            });
          }
          // Create design (open Canva)
          if (designBtn) {
            designBtn.addEventListener('click', function() {
              window.open('https://www.canva.com/', '_blank');
            });
          }
          // Erase/Restore (simple demo)
          if (eraseBtn && outputImg) {
            let erasing = false;
            let canvas = null;
            let ctx = null;
            eraseBtn.addEventListener('click', function() {
              if (canvas) return; // Already active
              // Create canvas overlay
              canvas = document.createElement('canvas');
              canvas.width = outputImg.naturalWidth;
              canvas.height = outputImg.naturalHeight;
              canvas.style.position = 'absolute';
              canvas.style.left = outputImg.offsetLeft + 'px';
              canvas.style.top = outputImg.offsetTop + 'px';
              canvas.style.width = outputImg.width + 'px';
              canvas.style.height = outputImg.height + 'px';
              canvas.style.cursor = 'crosshair';
              canvas.style.zIndex = 10;
              outputWrapper.style.position = 'relative';
              outputWrapper.appendChild(canvas);
              ctx = canvas.getContext('2d');
              ctx.clearRect(0, 0, canvas.width, canvas.height);
              erasing = false;
              // Draw brush on click/drag
              function drawErase(x, y) {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.beginPath();
                ctx.arc(x, y, 30, 0, 2 * Math.PI);
                ctx.fill();
              }
              canvas.addEventListener('mousedown', function(e) {
                erasing = true;
                const rect = canvas.getBoundingClientRect();
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                drawErase((e.clientX - rect.left) * scaleX, (e.clientY - rect.top) * scaleY);
              });
              canvas.addEventListener('mousemove', function(e) {
                if (!erasing) return;
                const rect = canvas.getBoundingClientRect();
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                drawErase((e.clientX - rect.left) * scaleX, (e.clientY - rect.top) * scaleY);
              });
              window.addEventListener('mouseup', function() { erasing = false; });
              // Restore: double click to remove canvas
              canvas.addEventListener('dblclick', function() {
                outputWrapper.removeChild(canvas);
                canvas = null;
              });
            });
          }
        }, 400);
      };
      imageInput.addEventListener('change', function() {
        if (imageInput.files.length) {
          uploadForm.requestSubmit();
        }
      });
    </script>
  </section>
  <div class="supported">
    <div><strong>Supported Formats &amp; Limits</strong></div>
    <div>JPG, PNG, WebP &nbsp; • &nbsp; Max 10MB file size &nbsp; • &nbsp; HD quality output</div>
  </div>
  <footer class="footer-section">
    <div class="footer-container">
      <div>
        <h4>Features</h4>
        <ul>
          <li>Remove background from image</li>
          <li>Background remover</li>
          <li>Free background remover</li>
          <li>Image background eraser</li>
          <li>Automatic background removal</li>
          <li>Online background remover</li>
          <li>Transparent background maker</li>
        </ul>
      </div>
      <div>
        <h4>Solutions</h4>
        <ul>
          <li>For Individuals</li>
          <li>For Photographers</li>
          <li>For Advertising</li>
          <li>For Developers</li>
          <li>For Car Dealers</li>
          <li>For News & Media</li>
          <li>For Ecommerce</li>
          <li>For Enterprise</li>
        </ul>
      </div>
      <div>
        <h4>Tools &amp; API</h4>
        <ul>
          <li>API Documentation</li>
          <li>Integrations, tools &amp; apps</li>
          <li>Photoshop Extension</li>
          <li>Windows / Mac / Linux</li>
          <li>On Premise</li>
          <li>Mobile App</li>
          <li>Design Maker</li>
        </ul>
      </div>
      <div>
        <h4>Company</h4>
        <ul>
          <li>About Us</li>
          <li>Blog</li>
          <li>Terms of service</li>
          <li>General Terms and Conditions</li>
          <li>Privacy Policy</li>
          <li>Contact Us</li>
          <li>Help &amp; FAQ</li>
          <li>Refund Policy</li>
        </ul>
      </div>
    </div>
  </footer>
  <script>
    // Image preview
    const dropArea = document.getElementById('drop-area');
    const browseLink = document.getElementById('browse-link');
    const uploadIcon = document.getElementById('upload-icon');
    // Make icon clickable
    uploadIcon.addEventListener('click', function(e) {
      imageInput.click();
    });
    imageInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          // Optionally show preview in upload box if needed
        };
        reader.readAsDataURL(file);
      }
    });
    dropArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropArea.style.borderColor = '#6366f1';
    });
    dropArea.addEventListener('dragleave', (e) => {
      e.preventDefault();
      dropArea.style.borderColor = '#d1d5db';
    });
    dropArea.addEventListener('drop', (e) => {
      e.preventDefault();
      dropArea.style.borderColor = '#d1d5db';
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        imageInput.files = files;
        const event = new Event('change');
        imageInput.dispatchEvent(event);
      }
    });
    browseLink.onclick = function(e) {
      e.preventDefault();
      imageInput.click();
    };

    // Color Picker Function
    function showColorPicker(outputWrapper, sidebarColorPicker = null) {
      const currentColor = outputWrapper.style.background || '#ffffff';

      // Create popup
      const popup = document.createElement('div');
      popup.className = 'color-picker-popup';
      popup.innerHTML = `
        <div class="color-picker-header">
          <div class="color-picker-title">Choose Background Color</div>
          <button class="color-picker-close">×</button>
        </div>
        <div id="color-picker-container"></div>
        <div class="color-picker-input">
          <input type="text" id="color-input" value="${currentColor}" placeholder="#ffffff">
          <button class="color-picker-apply">Apply</button>
        </div>
        <div style="margin-top:16px; text-align:center;">
          <button id="color-picker-upload-btn" style="padding:8px 18px;border-radius:8px;background:linear-gradient(90deg,#6366f1,#f472b6);color:#fff;font-weight:600;border:none;cursor:pointer;">Upload Image</button>
          <input type="file" id="color-picker-upload-input" accept="image/*" style="display:none;">
          <button id="color-picker-remove-img-btn" style="display:none;margin-top:8px;padding:6px 16px;border-radius:8px;background:#f472b6;color:#fff;font-weight:600;border:none;cursor:pointer;">Remove Image</button>
          <div id="color-picker-image-preview" style="margin-top:10px;"></div>
        </div>
      `;

      // --- Position popup at Background button ---
      const bgBtn = document.getElementById('bgcolor-btn');
      if (bgBtn) {
        const rect = bgBtn.getBoundingClientRect();
        popup.style.position = 'fixed';
        popup.style.left = rect.left + 'px';
        popup.style.top = rect.top + 'px';
        popup.style.transform = 'none';
        document.body.appendChild(popup);
      } else {
        // fallback: center
        popup.style.position = 'fixed';
        popup.style.top = '50%';
        popup.style.left = '50%';
        popup.style.transform = 'translate(-50%, -50%)';
        document.body.appendChild(popup);
      }

      // --- Hide all sidebar buttons except Erase/Restore ---
      const sidebar = document.getElementById('effects-sidebar');
      if (sidebar) {
        Array.from(sidebar.children).forEach(child => {
          if (!child.id || child.id !== 'erase-btn') {
            child.style.display = 'none';
          } else {
            child.style.display = '';
          }
        });
      }

      const pickerContainer = document.getElementById('color-picker-container');
      const colorInput = document.getElementById('color-input');
      const closeBtn = popup.querySelector('.color-picker-close');
      const applyBtn = popup.querySelector('.color-picker-apply');
      const uploadBtn = popup.querySelector('#color-picker-upload-btn');
      const uploadInput = popup.querySelector('#color-picker-upload-input');
      const imagePreview = popup.querySelector('#color-picker-image-preview');
      const removeImgBtn = popup.querySelector('#color-picker-remove-img-btn');
      
      let selectedColor = currentColor;
      let uploadedImageDataUrl = null;
      
      // Create a simple but beautiful color picker
      const picker = document.createElement('div');
      picker.style.cssText = `
        width: 240px;
        height: 240px;
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid #e5e7eb;
        background: linear-gradient(45deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
        cursor: crosshair;
        position: relative;
      `;
      
      // Add color preview
      const preview = document.createElement('div');
      preview.style.cssText = `
        position: absolute;
        top: 10px;
        right: 10px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 3px solid white;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        background: ${selectedColor};
      `;
      
      picker.appendChild(preview);
      pickerContainer.appendChild(picker);
      
      // Handle color selection
      picker.addEventListener('click', function(e) {
        const rect = picker.getBoundingClientRect();
        const x = (e.clientX - rect.left) / rect.width;
        const y = (e.clientY - rect.top) / rect.height;
        
        // Convert position to color (simplified)
        const hue = Math.round(x * 360);
        const saturation = Math.max(50, Math.round((1 - y) * 100));
        const lightness = Math.max(30, Math.round(y * 70));
        
        const color = `hsl(${hue}, ${saturation}%, ${lightness}%)`;
        selectedColor = color;
        uploadedImageDataUrl = null;
        colorInput.value = color;
        preview.style.background = color;
        imagePreview.innerHTML = '';
        outputWrapper.style.background = color;
        outputWrapper.style.backgroundImage = '';
        removeImgBtn.style.display = 'none';
      });
      
      // Handle manual input
      colorInput.addEventListener('input', function(e) {
        selectedColor = e.target.value;
        uploadedImageDataUrl = null;
        preview.style.background = selectedColor;
        imagePreview.innerHTML = '';
        outputWrapper.style.background = selectedColor;
        outputWrapper.style.backgroundImage = '';
        removeImgBtn.style.display = 'none';
      });
      
      // Add preset colors
      const presets = ['#ffffff', '#000000', '#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff8000', '#8000ff'];
      const presetContainer = document.createElement('div');
      presetContainer.style.cssText = `
        display: flex;
        gap: 8px;
        margin-top: 16px;
        flex-wrap: wrap;
        justify-content: center;
      `;
      
      presets.forEach(color => {
        const preset = document.createElement('div');
        preset.style.cssText = `
          width: 24px;
          height: 24px;
          border-radius: 50%;
          background: ${color};
          border: 2px solid #e5e7eb;
          cursor: pointer;
          transition: transform 0.2s;
        `;
        preset.addEventListener('click', function() {
          selectedColor = color;
          uploadedImageDataUrl = null;
          colorInput.value = color;
          preview.style.background = color;
          imagePreview.innerHTML = '';
          outputWrapper.style.background = color;
          outputWrapper.style.backgroundImage = '';
          removeImgBtn.style.display = 'none';
        });
        preset.addEventListener('mouseenter', function() {
          this.style.transform = 'scale(1.1)';
        });
        preset.addEventListener('mouseleave', function() {
          this.style.transform = 'scale(1)';
        });
        presetContainer.appendChild(preset);
      });
      
      pickerContainer.appendChild(presetContainer);

      // --- Upload Image functionality ---
      uploadBtn.addEventListener('click', function() {
        uploadInput.click();
      });
      uploadInput.addEventListener('change', function(e) {
        const file = uploadInput.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(evt) {
            uploadedImageDataUrl = evt.target.result;
            selectedColor = null;
            preview.style.background = '#eee';
            preview.style.backgroundImage = `url('${uploadedImageDataUrl}')`;
            preview.style.backgroundSize = 'cover';
            preview.style.backgroundPosition = 'center';
            colorInput.value = file.name || 'Image';
            imagePreview.innerHTML = `<img src='${uploadedImageDataUrl}' style='max-width:120px;max-height:80px;border-radius:8px;box-shadow:0 2px 8px #a78bfa22;margin-top:6px;'>`;
            outputWrapper.style.background = '';
            outputWrapper.style.backgroundImage = `url('${uploadedImageDataUrl}')`;
            outputWrapper.style.backgroundSize = 'cover';
            outputWrapper.style.backgroundPosition = 'center';
            removeImgBtn.style.display = '';
          };
          reader.readAsDataURL(file);
        }
      });

      // --- Remove Image functionality ---
      removeImgBtn.addEventListener('click', function() {
        uploadedImageDataUrl = null;
        outputWrapper.style.backgroundImage = '';
        outputWrapper.style.background = '#ffffff';
        preview.style.background = '#ffffff';
        preview.style.backgroundImage = '';
        colorInput.value = '#ffffff';
        imagePreview.innerHTML = '';
        removeImgBtn.style.display = 'none';
      });

      // Restore sidebar buttons on close
      function restoreSidebar() {
        if (sidebar) {
          Array.from(sidebar.children).forEach(child => {
            child.style.display = '';
          });
        }
      }

      closeBtn.addEventListener('click', function() {
        popup.remove();
        restoreSidebar();
      });
      applyBtn.addEventListener('click', function() {
        if (uploadedImageDataUrl) {
          outputWrapper.style.background = '';
          outputWrapper.style.backgroundImage = `url('${uploadedImageDataUrl}')`;
          outputWrapper.style.backgroundSize = 'cover';
          outputWrapper.style.backgroundPosition = 'center';
        } else {
          outputWrapper.style.background = selectedColor;
          outputWrapper.style.backgroundImage = '';
        }
        popup.remove();
        restoreSidebar();
      });

      // --- Ensure Erase/Restore button is always clickable ---
      const eraseBtn = document.getElementById('erase-btn');
      if (eraseBtn) {
        eraseBtn.onclick = null;
        eraseBtn.addEventListener('click', function() {
          // Prevent multiple overlays
          if (document.getElementById('erase-canvas-overlay')) return;
          // Create canvas overlay
          const outputWrapper = document.getElementById('output-wrapper');
          const outputImg = document.getElementById('output-img');
          if (!outputWrapper || !outputImg) return;
          const canvas = document.createElement('canvas');
          canvas.id = 'erase-canvas-overlay';
          canvas.width = outputImg.naturalWidth;
          canvas.height = outputImg.naturalHeight;
          canvas.style.position = 'absolute';
          canvas.style.left = outputImg.offsetLeft + 'px';
          canvas.style.top = outputImg.offsetTop + 'px';
          canvas.style.width = outputImg.width + 'px';
          canvas.style.height = outputImg.height + 'px';
          canvas.style.cursor = 'crosshair';
          canvas.style.zIndex = 20;
          outputWrapper.style.position = 'relative';
          outputWrapper.appendChild(canvas);
          const ctx = canvas.getContext('2d');
          let originalImageData = null;
          const img = new window.Image();
          img.crossOrigin = 'anonymous';
          img.src = outputImg.src;
          img.onload = function() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
          };
          // Toolbar
          const toolbar = document.createElement('div');
          toolbar.id = 'erase-toolbar';
          toolbar.style.position = 'absolute';
          toolbar.style.top = '10px';
          toolbar.style.left = '10px';
          toolbar.style.background = '#fff';
          toolbar.style.borderRadius = '8px';
          toolbar.style.padding = '6px 12px';
          toolbar.style.boxShadow = '0 2px 8px #a78bfa22';
          toolbar.style.zIndex = 30;
          toolbar.style.display = 'flex';
          toolbar.style.alignItems = 'center';
          toolbar.style.gap = '8px';
          toolbar.innerHTML = `
            <button id='erase-mode-btn' style='background:#6366f1;color:#fff;border:none;padding:4px 10px;border-radius:6px;font-weight:600;cursor:pointer;'>Erase</button>
            <button id='restore-mode-btn' style='background:#fbbf24;color:#fff;border:none;padding:4px 10px;border-radius:6px;font-weight:600;cursor:pointer;'>Restore</button>
            <input type='range' id='brush-size' min='10' max='80' value='30' style='vertical-align:middle;'>
            <span id='brush-size-label'>30</span>
            <button id='reset-erase-btn' style='background:#f472b6;color:#fff;border:none;padding:4px 10px;border-radius:6px;font-weight:600;cursor:pointer;'>Reset</button>
            <button id='close-erase-btn' style='background:#e5e7eb;color:#222;border:none;padding:4px 10px;border-radius:6px;font-weight:600;cursor:pointer;'>Close</button>
          `;
          outputWrapper.appendChild(toolbar);
          // Toolbar events
          let eraseMode = true;
          let brushSize = 30;
          toolbar.querySelector('#erase-mode-btn').onclick = () => { eraseMode = true; };
          toolbar.querySelector('#restore-mode-btn').onclick = () => { eraseMode = false; };
          toolbar.querySelector('#brush-size').oninput = e => {
            brushSize = +e.target.value;
            toolbar.querySelector('#brush-size-label').textContent = brushSize;
          };
          toolbar.querySelector('#reset-erase-btn').onclick = () => {
            if (originalImageData) ctx.putImageData(originalImageData, 0, 0);
          };
          toolbar.querySelector('#close-erase-btn').onclick = () => {
            // Save the edited canvas as the new output image
            const dataUrl = canvas.toDataURL('image/png');
            outputImg.src = dataUrl;
            outputImg.style.background = 'transparent';
            // Update Download button to use the cutout PNG
            const downloadBtn = document.querySelector('a[download]');
            if (downloadBtn) {
              downloadBtn.href = dataUrl;
            }
            outputWrapper.removeChild(canvas);
            outputWrapper.removeChild(toolbar);
          };
          // Drawing logic
          let drawing = false;
          function draw(x, y) {
            ctx.save();
            ctx.beginPath();
            ctx.arc(x, y, brushSize, 0, 2 * Math.PI);
            ctx.closePath();
            if (eraseMode) {
              ctx.globalCompositeOperation = 'destination-out';
              ctx.fill();
            } else {
              ctx.globalCompositeOperation = 'source-over';
              if (originalImageData) {
                // Restore only the brushed area
                const sx = Math.max(0, Math.round(x - brushSize));
                const sy = Math.max(0, Math.round(y - brushSize));
                const sw = Math.min(canvas.width - sx, brushSize * 2);
                const sh = Math.min(canvas.height - sy, brushSize * 2);
                const patch = ctx.createImageData(sw, sh);
                const orig = originalImageData.data;
                for (let py = 0; py < sh; py++) {
                  for (let px = 0; px < sw; px++) {
                    const idx = ((py + sy) * canvas.width + (px + sx)) * 4;
                    const pidx = (py * sw + px) * 4;
                    patch.data[pidx] = orig[idx];
                    patch.data[pidx+1] = orig[idx+1];
                    patch.data[pidx+2] = orig[idx+2];
                    patch.data[pidx+3] = orig[idx+3];
                  }
                }
                ctx.putImageData(patch, sx, sy);
              }
            }
            ctx.restore();
          }

          canvas.addEventListener('mousedown', function(e) {
            drawing = true;
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            draw((e.clientX - rect.left) * scaleX, (e.clientY - rect.top) * scaleY);
          });
          canvas.addEventListener('mousemove', function(e) {
            if (!drawing) return;
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            draw((e.clientX - rect.left) * scaleX, (e.clientY - rect.top) * scaleY);
          });
          window.addEventListener('mouseup', function() { drawing = false; });
        });
      }
    }

    // --- Effects Sidebar Functionality ---
    const outputWrapper = document.getElementById('output-wrapper');
    const outputImg = document.getElementById('output-img');
    const bgcolorBtn = document.getElementById('bgcolor-btn');
    const eraseBtn = document.getElementById('erase-btn');
    const effectsSelect = document.getElementById('effects-select');
    const designBtn = document.getElementById('design-btn');
    if (outputWrapper && outputImg) {
      // Background color change from sidebar button
      if (bgcolorBtn) {
        bgcolorBtn.addEventListener('click', function() {
          showColorPicker(outputWrapper, null);
        });
      }
      // Background color change on background click
      outputWrapper.addEventListener('click', function(e) {
        // Only trigger if clicking on the background, not on the image
        if (e.target === outputWrapper) {
          showColorPicker(outputWrapper, null);
        }
      });
      // Erase/Restore usable implementation
      if (eraseBtn) {
        eraseBtn.addEventListener('click', function() {
          // Prevent multiple overlays
          if (document.getElementById('erase-canvas-overlay')) return;

          // Create canvas overlay
          const canvas = document.createElement('canvas');
          canvas.id = 'erase-canvas-overlay';
          canvas.width = outputImg.naturalWidth;
          canvas.height = outputImg.naturalHeight;
          canvas.style.position = 'absolute';
          canvas.style.left = outputImg.offsetLeft + 'px';
          canvas.style.top = outputImg.offsetTop + 'px';
          canvas.style.width = outputImg.width + 'px';
          canvas.style.height = outputImg.height + 'px';
          canvas.style.cursor = 'crosshair';
          canvas.style.zIndex = 20;
          outputWrapper.style.position = 'relative';
          outputWrapper.appendChild(canvas);

          const ctx = canvas.getContext('2d');
          let originalImageData = null;

          // Draw the image on canvas only after it is loaded
          const img = new window.Image();
          img.crossOrigin = 'anonymous'; // In case of CORS issues
          img.src = outputImg.src;
          img.onload = function() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
          };

          // Toolbar
          const toolbar = document.createElement('div');
          toolbar.id = 'erase-toolbar';
          toolbar.style.position = 'absolute';
          toolbar.style.top = '10px';
          toolbar.style.left = '10px';
          toolbar.style.background = '#fff';
          toolbar.style.borderRadius = '8px';
          toolbar.style.padding = '6px 12px';
          toolbar.style.boxShadow = '0 2px 8px #a78bfa22';
          toolbar.style.zIndex = 30;
          toolbar.style.display = 'flex';
          toolbar.style.alignItems = 'center';
          toolbar.style.gap = '8px';
          toolbar.innerHTML = `
            <button id='erase-mode-btn' style='background:#6366f1;color:#fff;border:none;padding:4px 10px;border-radius:6px;font-weight:600;cursor:pointer;'>Erase</button>
            <button id='restore-mode-btn' style='background:#fbbf24;color:#fff;border:none;padding:4px 10px;border-radius:6px;font-weight:600;cursor:pointer;'>Restore</button>
            <input type='range' id='brush-size' min='10' max='80' value='30' style='vertical-align:middle;'>
            <span id='brush-size-label'>30</span>
            <button id='reset-erase-btn' style='background:#f472b6;color:#fff;border:none;padding:4px 10px;border-radius:6px;font-weight:600;cursor:pointer;'>Reset</button>
            <button id='close-erase-btn' style='background:#e5e7eb;color:#222;border:none;padding:4px 10px;border-radius:6px;font-weight:600;cursor:pointer;'>Close</button>
          `;
          outputWrapper.appendChild(toolbar);

          // Toolbar events
          let eraseMode = true;
          let brushSize = 30;
          toolbar.querySelector('#erase-mode-btn').onclick = () => { eraseMode = true; };
          toolbar.querySelector('#restore-mode-btn').onclick = () => { eraseMode = false; };
          toolbar.querySelector('#brush-size').oninput = e => {
            brushSize = +e.target.value;
            toolbar.querySelector('#brush-size-label').textContent = brushSize;
          };
          toolbar.querySelector('#reset-erase-btn').onclick = () => {
            if (originalImageData) ctx.putImageData(originalImageData, 0, 0);
          };
          toolbar.querySelector('#close-erase-btn').onclick = () => {
            // Save the edited canvas as the new output image
            const dataUrl = canvas.toDataURL('image/png');
            outputImg.src = dataUrl;
            outputImg.style.background = 'transparent';
            // Update Download button to use the cutout PNG
            const downloadBtn = document.querySelector('a[download]');
            if (downloadBtn) {
              downloadBtn.href = dataUrl;
            }
            outputWrapper.removeChild(canvas);
            outputWrapper.removeChild(toolbar);
          };

          // Drawing logic
          let drawing = false;
          function draw(x, y) {
            ctx.save();
            ctx.beginPath();
            ctx.arc(x, y, brushSize, 0, 2 * Math.PI);
            ctx.closePath();
            if (eraseMode) {
              ctx.globalCompositeOperation = 'destination-out';
              ctx.fill();
            } else {
              ctx.globalCompositeOperation = 'source-over';
              if (originalImageData) {
                // Restore only the brushed area
                const sx = Math.max(0, Math.round(x - brushSize));
                const sy = Math.max(0, Math.round(y - brushSize));
                const sw = Math.min(canvas.width - sx, brushSize * 2);
                const sh = Math.min(canvas.height - sy, brushSize * 2);
                const patch = ctx.createImageData(sw, sh);
                const orig = originalImageData.data;
                for (let py = 0; py < sh; py++) {
                  for (let px = 0; px < sw; px++) {
                    const idx = ((py + sy) * canvas.width + (px + sx)) * 4;
                    const pidx = (py * sw + px) * 4;
                    patch.data[pidx] = orig[idx];
                    patch.data[pidx+1] = orig[idx+1];
                    patch.data[pidx+2] = orig[idx+2];
                    patch.data[pidx+3] = orig[idx+3];
                  }
                }
                ctx.putImageData(patch, sx, sy);
              }
            }
            ctx.restore();
          }

          canvas.addEventListener('mousedown', function(e) {
            drawing = true;
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            draw((e.clientX - rect.left) * scaleX, (e.clientY - rect.top) * scaleY);
          });
          canvas.addEventListener('mousemove', function(e) {
            if (!drawing) return;
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            draw((e.clientX - rect.left) * scaleX, (e.clientY - rect.top) * scaleY);
          });
          window.addEventListener('mouseup', function() { drawing = false; });
        });
      }
    }

    // Show/hide toolbar panel logic
    const showToolbarBtn = document.getElementById('show-erase-toolbar');
    const toolbarPanel = document.getElementById('erase-toolbar-panel');
    const closeBtn = document.getElementById('toolbar-close-btn');
    showToolbarBtn.onclick = function() {
      toolbarPanel.style.display = 'block';
    };
    closeBtn.onclick = function() {
      toolbarPanel.style.display = 'none';
    };
    // Toolbar controls (hooks for brush logic)
    const eraseToolbarBtn = document.getElementById('toolbar-erase');
    const restoreToolbarBtn = document.getElementById('toolbar-restore');
    const brushSizeInput = document.getElementById('toolbar-brush-size');
    const brushValue = document.getElementById('toolbar-brush-value');
    const resetBtn = document.getElementById('toolbar-reset');
    // Toggle active mode
    eraseToolbarBtn.onclick = function() {
      eraseToolbarBtn.classList.add('active');
      restoreToolbarBtn.classList.remove('active');
      // TODO: Set brush to erase mode (black)
    };
    restoreToolbarBtn.onclick = function() {
      restoreToolbarBtn.classList.add('active');
      eraseToolbarBtn.classList.remove('active');
      // TODO: Set brush to restore mode (white)
    };
    brushSizeInput.oninput = function(e) {
      brushValue.textContent = e.target.value;
      // TODO: Set brush size
    };
    resetBtn.onclick = function() {
      // TODO: Reset mask logic
    };

    // Hugging Face Space API Integration
    async function callHuggingFaceAPI(selectedFile) {
      try {
        // Show loading state
        const removeBtn = document.querySelector('.remove-btn');
        const originalText = removeBtn.textContent;
        removeBtn.textContent = 'Processing...';
        removeBtn.disabled = true;

        const formData = new FormData();
        formData.append("file", selectedFile);

        const response = await fetch("https://ravikumar619-bgclean1.hf.space/remove-background", {
          method: "POST",
          body: formData,
        });

        if (!response.ok) {
          throw new Error(`Failed: ${response.status} - ${response.statusText}`);
        }

        const blob = await response.blob();
        const imageUrl = URL.createObjectURL(blob);
        
        // Display the result
        const outputImg = document.getElementById('output-img');
        if (outputImg) {
          outputImg.src = imageUrl;
          outputImg.style.display = 'block';
        }

        // Update download link
        const downloadBtn = document.querySelector('a[download]');
        if (downloadBtn) {
          downloadBtn.href = imageUrl;
          downloadBtn.download = 'bg-removed.png';
        }

        // Show success message
        console.log('Background removed successfully!');
        
      } catch (error) {
        console.error('Error:', error);
        alert('Error processing image: ' + error.message);
      } finally {
        // Reset button state
        const removeBtn = document.querySelector('.remove-btn');
        removeBtn.textContent = originalText;
        removeBtn.disabled = false;
      }
    }

    // Update existing file upload handler to use Hugging Face API
    const fileInput = document.querySelector('input[type="file"]');
    if (fileInput) {
      fileInput.addEventListener('change', function(e) {
        const selectedFile = e.target.files[0];
        if (selectedFile) {
          // Show preview
          const reader = new FileReader();
          reader.onload = function(e) {
            const previewImg = document.getElementById('preview-img');
            if (previewImg) {
              previewImg.src = e.target.result;
              previewImg.style.display = 'block';
            }
          };
          reader.readAsDataURL(selectedFile);
        }
      });
    }

    // Update remove background button to use Hugging Face API
    const removeBackgroundBtn = document.querySelector('.remove-btn');
    if (removeBackgroundBtn) {
      removeBackgroundBtn.addEventListener('click', function() {
        const fileInput = document.querySelector('input[type="file"]');
        const selectedFile = fileInput.files[0];
        
        if (!selectedFile) {
          alert('Please select an image first!');
          return;
        }

        // Call Hugging Face API
        callHuggingFaceAPI(selectedFile);
      });
    }
  </script>
</body>
</html> 
